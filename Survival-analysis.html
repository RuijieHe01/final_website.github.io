<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Survival Analysis</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="Project_plan.html">Project Plan</a>
</li>
<li>
  <a href="Introduction.html">Introduction</a>
</li>
<li>
  <a href="Data.html">Data</a>
</li>
<li>
  <a href="Survival-analysis.html">Survival Analysis</a>
</li>
<li>
  <a href="Modeling.html">Modeling</a>
</li>
<li>
  <a href="Conclusion.html">Conclusion</a>
</li>
<li>
  <a href="https://mingzhicumc.shinyapps.io/shiny_dashboard_template/">Shiny App</a>
</li>
<li>
  <a href="Project-report.html">Report</a>
</li>
<li>
  <a href="mailto:rh3195@cumc.columbia.edu?subject=About%20your%20website">
    <span class="fa fa-youtube fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/RuijieHe01/final_website.github.io/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Survival Analysis</h1>

</div>


 
<div id="model-selection-with-tests" class="section level1">
<h1>Model selection with tests</h1>
<pre class="r"><code>summary(stepwise) </code></pre>
<pre><code>Call:
coxph(formula = Surv(time, cid) ~ preanti + symptom + treat + 
    offtrt + cd420 + cd820, data = data)

  n= 2139, number of events= 521 

              coef  exp(coef)   se(coef)       z Pr(&gt;|z|)    
preanti  3.354e-04  1.000e+00  9.130e-05   3.674 0.000239 ***
symptom  3.609e-01  1.435e+00  1.011e-01   3.570 0.000357 ***
treat   -4.872e-01  6.143e-01  9.253e-02  -5.266 1.40e-07 ***
offtrt   4.502e-01  1.569e+00  9.097e-02   4.948 7.48e-07 ***
cd420   -7.403e-03  9.926e-01  4.578e-04 -16.172  &lt; 2e-16 ***
cd820    4.689e-04  1.000e+00  9.449e-05   4.963 6.94e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

        exp(coef) exp(-coef) lower .95 upper .95
preanti    1.0003     0.9997    1.0002    1.0005
symptom    1.4346     0.6971    1.1767    1.7490
treat      0.6143     1.6278    0.5124    0.7365
offtrt     1.5686     0.6375    1.3124    1.8747
cd420      0.9926     1.0074    0.9917    0.9935
cd820      1.0005     0.9995    1.0003    1.0007

Concordance= 0.766  (se = 0.01 )
Likelihood ratio test= 485.6  on 6 df,   p=&lt;2e-16
Wald test            = 411.6  on 6 df,   p=&lt;2e-16
Score (logrank) test = 425.9  on 6 df,   p=&lt;2e-16</code></pre>
<pre class="r"><code>broom::tidy(stepwise) |&gt;kbl()</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
preanti
</td>
<td style="text-align:right;">
0.0003354
</td>
<td style="text-align:right;">
0.0000913
</td>
<td style="text-align:right;">
3.673646
</td>
<td style="text-align:right;">
0.0002391
</td>
</tr>
<tr>
<td style="text-align:left;">
symptom
</td>
<td style="text-align:right;">
0.3608808
</td>
<td style="text-align:right;">
0.1010939
</td>
<td style="text-align:right;">
3.569759
</td>
<td style="text-align:right;">
0.0003573
</td>
</tr>
<tr>
<td style="text-align:left;">
treat
</td>
<td style="text-align:right;">
-0.4872220
</td>
<td style="text-align:right;">
0.0925251
</td>
<td style="text-align:right;">
-5.265835
</td>
<td style="text-align:right;">
0.0000001
</td>
</tr>
<tr>
<td style="text-align:left;">
offtrt
</td>
<td style="text-align:right;">
0.4501628
</td>
<td style="text-align:right;">
0.0909720
</td>
<td style="text-align:right;">
4.948366
</td>
<td style="text-align:right;">
0.0000007
</td>
</tr>
<tr>
<td style="text-align:left;">
cd420
</td>
<td style="text-align:right;">
-0.0074031
</td>
<td style="text-align:right;">
0.0004578
</td>
<td style="text-align:right;">
-16.172233
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
cd820
</td>
<td style="text-align:right;">
0.0004689
</td>
<td style="text-align:right;">
0.0000945
</td>
<td style="text-align:right;">
4.962948
</td>
<td style="text-align:right;">
0.0000007
</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Our goal is to investigate the difference between two groups of
different treatments(ZDV), therefore we pre-specified to stratify by
treatment in the model.</p>
</blockquote>
</div>
<div id="graphical-methods" class="section level1">
<h1>Graphical Methods</h1>
<p>Recall a PH model, <span class="math inline">\(S(t|Z=z) = e^{-\int
h_0(t)e^{\beta z}dt} = S_0(t)^{e^{\beta z}}\)</span>, by using a log-log
transformation, i.e., <span
class="math inline">\(log\{-logS(t|Z=z)\}\)</span>, we have <span
class="math display">\[log\{-log\hat{S}(t|Z=z)\}-log\{-log\hat{S_0}(t)\}
= \beta \]</span> for indicator variable <span
class="math inline">\(Z\)</span>. This indicates two parallel lines
under proportionality assumption.</p>
<pre class="r"><code>library(ggfortify)
library(StepReg)
data_fit &lt;- data |&gt;
  dplyr::select(time, cid, treat, preanti, symptom, offtrt, cd420, cd820) |&gt;
  mutate_at(c(3, 5, 6), .funs = ~as.factor(.))


# --- treat ---
# km plot
fit_km_treat &lt;- survfit(Surv(time, cid) ~ treat, data_fit)
autoplot(fit_km_treat) + theme_bw() +
  labs(x = &quot;Time (days)&quot;, y = &quot;Survival Function&quot;,
       title = &quot;Kaplan-Meier Survival Estimate&quot;)</code></pre>
<p><img src="Survival-analysis_files/figure-html/unnamed-chunk-2-1.png" width="1200" style="display: block; margin: auto;" /></p>
<pre class="r"><code># loglog vs. log time
# png(&quot;ph_checking_1.png&quot;, width = 500, height = 400)
plot(fit_km_treat, fun = &quot;cloglog&quot;, col = c(&quot;black&quot;, &quot;red&quot;),
     xlab = &quot;Time (days in log scale)&quot;, ylab = &quot;log{-log(S(t))}&quot;,
     main = &quot;Log of Negative Log of Estimated Survival Functions&quot;)
legend(&quot;topleft&quot;, legend = c(&quot;ZDV only&quot;, &quot;Others&quot;), col = c(&quot;black&quot;, &quot;red&quot;), 
       lty = 1, cex = 1)</code></pre>
<p><img src="Survival-analysis_files/figure-html/unnamed-chunk-2-2.png" width="1200" style="display: block; margin: auto;" /></p>
<pre class="r"><code># observed vs. fitted
fit_ph_treat &lt;- coxph(Surv(time, cid) ~ treat, data_fit)

# png(&quot;ph_checking_2.png&quot;, width = 500, height = 400)
plot(fit_km_treat, col = c(&quot;blue&quot;, &quot;darkgreen&quot;),
     xlab = &quot;Time (days)&quot;, ylab = &quot;Survival Function&quot;,
     ylim = c(0.4,1),
     main = &quot;Observed vs. Fitted&quot;)
lines(survfit(fit_ph_treat, newdata = data.frame(treat = as.factor(0))), # 0
      col = &quot;red&quot;, conf.int = FALSE)
lines(survfit(fit_ph_treat, newdata = data.frame(treat = as.factor(1))), # 1
      col = &quot;black&quot;, conf.int = FALSE)
legend(&quot;bottomleft&quot;, legend = c(&quot;Observed Male&quot;, &quot;Observed Female&quot;,
                                &quot;Fitted Male&quot;, &quot;Fitted Female&quot;), 
       col = c(&quot;blue&quot;, &quot;darkgreen&quot;, &quot;red&quot;, &quot;black&quot;), lty = 1, cex = 1, lwd = 2)</code></pre>
<p><img src="Survival-analysis_files/figure-html/unnamed-chunk-2-3.png" width="1200" style="display: block; margin: auto;" /></p>
<p><strong>Interpretation:</strong> The above two figures demonstrate
the proportional hazards assumption is hold given there is only one
indicator variable <code>treat</code> in the model.</p>
<ul>
<li>The above methods work only for categorical variable, the slope in
plots of residuals such as Schoenfeld vs. time can be used instead for
continuous cases.</li>
</ul>
<div id="model-checking-ii" class="section level2">
<h2>Model checking II</h2>
<p>But first, let’s use the same covariates as above, plus the
corresponding interaction terms s.t., **covariate*time**. Results are
shown as follows.</p>
<div id="interaction-test" class="section level3">
<h3>Interaction test</h3>
<pre class="r"><code>library(survminer)
# --- to be updated ---

# interaction
aids_interaction_fit &lt;- coxph(Surv(time, cid == 1) ~ treat+ preanti+ symptom+ offtrt + cd420+ cd820+ log(time):treat+log(time):preanti+log(time):symptom+log(time):offtrt + log(time):cd420+log(time):cd820, data_fit)

summary(aids_interaction_fit)$coefficients |&gt;
  kable(&quot;latex&quot;, 
        digits = 4, 
        escape = F, 
        booktabs = T, 
caption = &quot;Regresion Coefficients Estimates of the Cox Model with Time Interactions&quot;) |&gt;
  kable_styling(position = &quot;center&quot;, 
                latex_options = &quot;hold_position&quot;)</code></pre>
<p>From the regression summary above, we can see that except
<code>cd820:log(time)</code>, all the selected variable has a
significant effect and interaction with time.</p>
<pre class="r"><code>aids_fit&lt;-coxph(Surv(time, cid) ~ ., data_fit)
# residual
ggcoxzph(cox.zph(aids_fit), var = c(&quot;cd420&quot;), df = 2, nsmo = 1000)</code></pre>
<p><img src="Survival-analysis_files/figure-html/unnamed-chunk-4-1.png" width="1200" style="display: block; margin: auto;" /></p>
<p>From the above plot and the Schoenfeld individual test p-value, we
can see that the residual plot has a non-zero slope regression line, and
the p-value of the tests is less than 0.05, which means the covariate
cd420 doesn’t meet the PH assumption.</p>
<pre class="r"><code># ggsave(&quot;ph_checking_4.png&quot;, width = 6, height = 4)
ggcoxzph(cox.zph(aids_fit), var = c(&quot;cd820&quot;), df = 2, nsmo = 1000)</code></pre>
<p><img src="Survival-analysis_files/figure-html/unnamed-chunk-5-1.png" width="1200" style="display: block; margin: auto;" /></p>
<p>However, the covariate cd820 is different.</p>
<p>Zero slop in the plot indicates : 1. PH model is valid 2. No
time-varying <span class="math inline">\(\beta_ j\)</span></p>
</div>
</div>
</div>
<div id="parametric-analysis" class="section level1">
<h1>Parametric Analysis</h1>
<div id="fit-exponential-and-weilbull-distributions"
class="section level3">
<h3>Fit exponential and Weilbull distributions</h3>
<pre class="r"><code>library(flexsurv)
#parametric survival function
fit_exp_others = flexsurvreg(Surv(time, cid == 1) ~ 1, 
                        data = subset(data_fit, treat == 1), dist = &quot;exp&quot;)
fit_exp_ZDV = flexsurvreg(Surv(time, cid == 1) ~ 1, 
                        data = subset(data_fit, treat == 0), dist = &quot;exp&quot;)
fit_weib_others = flexsurvreg(Surv(time, cid == 1) ~ 1, 
                        data = subset(data_fit, treat == 1), dist = &quot;weibull&quot;)
fit_weib_ZDV = flexsurvreg(Surv(time, cid == 1) ~ 1, 
                        data = subset(data_fit, treat == 0), dist = &quot;weibull&quot;)


#plot km, exp fitted and weib fitted
plot(fit_exp_ZDV, conf.int = FALSE, ci = FALSE, col = &quot;red&quot;, col.obs = &quot;pink&quot;, 
     lty = &quot;longdash&quot;, xlim = c(0,1300), 
     xlab = &quot;Days&quot;, ylab = &quot;Survival Probability&quot;,
     main = &quot;KM and Parametric Est&quot;)
par(new = TRUE)
plot(fit_exp_others, conf.int = FALSE, ci = FALSE, col = &quot;blue&quot;, col.obs = &quot;skyblue&quot;, lty = &quot;longdash&quot;, xlim = c(0,1000), xaxt = &quot;n&quot;)
plot(fit_weib_ZDV, add = TRUE, ci = FALSE, col = &quot;brown4&quot;)
plot(fit_weib_others, add = TRUE, ci = FALSE, col = &quot;blue4&quot;)
legend(&quot;bottomleft&quot;, legend = c(&quot;Obs ZDV&quot;, &quot;Obs others&quot;, &quot;Exp ZDV&quot;, &quot;Exp others&quot;, &quot;Weib ZDV&quot;, &quot;Weib others&quot;), 
       col = c(&quot;pink&quot;, &quot;skyblue&quot;, &quot;red&quot;, &quot;blue&quot;, &quot;brown4&quot;, &quot;blue4&quot;),
       lty = c(&quot;solid&quot;, &quot;solid&quot;, &quot;longdash&quot;, &quot;longdash&quot;, &quot;solid&quot;, &quot;solid&quot;),
       lwd = c(2,2,2,2,2,2))</code></pre>
<p><img src="Survival-analysis_files/figure-html/unnamed-chunk-6-1.png" width="1200" style="display: block; margin: auto;" /></p>
<p>From the plot we can see that the observations in different treatment
groups match different distributions. More specifically, the survival
function in the ZDV treatment group may be more likely to follow a
exponential distribution. Inversely, the other one follows a Weibull
distribution.</p>
</div>
<div id="parametric-regression-models" class="section level2">
<h2>Parametric Regression Models</h2>
<div id="parametric-ph-models" class="section level3">
<h3>Parametric PH Models</h3>
<pre class="r"><code>library(eha)
#backward selection, significance level = 0.05
fit_ph1 = eha::phreg(Surv(time, cid==1) ~ .,
                data = data_fit, dist = &quot;weibull&quot;)
summary(fit_ph1)|&gt;
  kable(&quot;latex&quot;, 
        digits = 4, 
        escape = F, 
        booktabs = T, 
caption = &quot;Weibull (Parametric) PH Model Fitting&quot;) |&gt;
  kable_styling(position = &quot;center&quot;, 
                latex_options = &quot;hold_position&quot;)
# it can be our final model


#compare the estimated baseline hazards with a non-parametric ph model
fit_cox =eha::coxreg(Surv(time, cid==1) ~ ., data = data_fit)
eha::check.dist(fit_ph1, fit_cox)</code></pre>
<p><img src="Weibull_Result.png" /></p>
<p>The fit of the Weibull baseline function is very close to the
non-parametric one.</p>
<p>For a Weibull distribution, the AFT model is also a PH model.</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
